# Tarvel SocialMedia - System Design

SystemDesign социальной сети для путешественников

Проект представляет из себя выполнение домашнего задания в рамках курса [System Design](https://balun.courses/courses/system_design#tariffs) 


## Функциональные зависимости

- публикация постов из путешествий с фотографиями, небольшим описанием и привязкой к конкретному месту путешествия
- оценка и комментарии постов других путешественников
- подписка на других путешественников, чтобы следить за их активностью
- поиск популярных мест для путешествий и просмотр постов с этих мест
- просмотр ленты других путешественников


## Нефункциональные зависимости 

- DAU = 10 000 000
- Доступность = 99.9%
- Есть сезонность: лето, новогодние и весенние каникулы - пик активности
- Аудитории только стран СНГ
- Данные хранятся всегда

  
- Лимиты:
	-  Максимум 25 постов в день 
		- Пост содержит от 1 до 5 фотографий
			- Максимум размер фото 10Мб
			- Поддерживаемые форматы jpeg/png
		- Максимальное описание поста 1000 символов
			- В описании не будут активны ссылки
	-  Максимум 50 подписок в день
	-  Максимум 500 лайков в день
	-  Максимум 200 комментариев в день 
		- Комментарий максимум 1000 символов
		- В комментариях не будут активны ссылки
 
    
- Тайминги:
	- Публикация поста: 2-3 секунды
	- Загрузка поста: 1-2 секунды 
	- Загрузка популярного поста: 1 секунда
	- Подписка, оценка и комментарии: 0-1 секунды (моментально)

   
- Активность:
	- Публикация постов:
		- В сезон активности - 1 пост в день 
		- В несезон - 1 пост в месяц
	- Просмотр постов:
		- 50 просмотров постов в день 
		- 5 оценок постов в день
		- 1 комментарий под постом в день 
		- 2 подписки в день 

    
## Оценка нагрузки

#### 1. Посты
	Размер поста
	1. Размер изображения: 2-3 Мб (в среднем 2.5 Мб)
	2. Кол-во изображений: 1-5 (в среднем 3)
	3. Размер подписи: 1Кб
	4. Размер геометки: 100 байт
	Итог: в среднем 8 Мб
	
RPS (read) = 10 000 000 * 50 / 86400 = 5800 \
RPS (write) в сезон = 10 000 000 * 1 / 86400 = 120 \
RPS (write) в несезон = 10 000 000 * (1 / 30) / 86400 = 4 

Traffic (read) = 5800 * 8 Мб = 46 400 Мб/с = 47 Гб \
Traffic (write) в сезон = 120 * 8 Мб =  960 Мб/c = 1 Гб/с \
Traffic (write) в несезон = 4 * 8 Мб = 32 Мб/c

Итог: система нацелена больше на чтение

---

#### 2. Комментарии 

    Максимум комментарий - 1000 байт 
    В среднем комментарий - 300 байт

RPS (write) комментарии = 10 000 000 * 1 / 86400 = 120 \
Traffic (write) комментарии = 120 * 300 Б = 36 Кб/с

---

#### 3. Реакции и подписки

	Структура запроса на Реакцию и Подписку
	1. user_id - uuid - 36 байт
	2. post_id/user_id - uuid - 36 байт 
	3. timestamp - iso8601 - 20 байт 
	Итог: 92 байта

RPS (write) реакции = 10 000 000 * 5 / 86400 = 580 \
Traffic (write) реакции = 580 * 92 Б =  54 Кб/c

RPS (write) подписки = 10 000 000 * 2 / 86400 = 240 \
Traffic (write) подписки = 240 * 92 Б =  23 Кб/с

## Оценка хранилища

Сезонная нагрузка = 3 месяца лета + январь + май = 5 месяцев  \
Несезонная нагрузка = 8 месяцев 

Месяц сезонной нагрузки = 1 Гб/с * 86400 * 30 = 2600 Тб \
Месяц несезонной нагрузки = 32 Мб/с * 86400 * 30 = 83 Тб

Год нагрузки на хранилище = 2600 Тб * 5 + 83 Тб * 8 = 13700 Тб = 13,7 Пб

## Одновременные соедиенния

Connections = 10 000 000 * 0.1 = 1 000 000 соединений
