# Tarvel SocialMedia - System Design

SystemDesign социальной сети для путешественников

Проект представляет из себя выполнение домашнего задания в рамках курса [System Design](https://balun.courses/courses/system_design#tariffs) 


## Функциональные требования

- публикация постов из путешествий с фотографиями, небольшим описанием и привязкой к конкретному месту путешествия
- оценка и комментарии постов других путешественников
- подписка на других путешественников, чтобы следить за их активностью
- поиск популярных мест для путешествий и просмотр постов с этих мест
- просмотр ленты других путешественников


## Нефункциональные требования 

- DAU = 10 000 000
- Доступность = 99.9%
- Есть сезонность, пик активности: 
  - лето: 3 месяца / 92 дня 
  - новогодние каникулы (конец декабря - начало января): 14 дней
  - весенние каникулы (начало мая): 10 дней
- Аудитории только стран СНГ
- Данные хранятся всегда

  
- Лимиты:
	-  Максимум 25 постов в день 
		- Пост содержит от 1 до 5 фотографий
			- Максимум размер фото 2Мб
			- Поддерживаемые форматы jpeg/png
		- Максимальное описание поста 1000 символов
			- В описании не будут активны ссылки
	-  Максимум 50 подписок в день
	-  Максимум 500 лайков в день
	-  Максимум 200 комментариев в день 
		- Комментарий максимум 1000 символов
		- В комментариях не будут активны ссылки
 
    
- Тайминги:
	- Публикация поста: 1 секунда
	- Загрузка поста: 1-2 секунды 
	- Загрузка популярного поста: 1 секунда
	- Подписка, оценка и комментарии: 0-1 секунды

   
- Активность:
	- Публикация постов:
		- В сезон активности - 1 пост в день 
		- В несезон - 1 пост в месяц
	- Просмотр постов:
		- 50 просмотров постов в день 
		- 5 оценок постов в день
		- 1 комментарий под постом в день 
		- 2 подписки в день 

    
## Оценка нагрузки

#### 1. Посты
	Размер поста
	Медиафайлы:
	  1. Размер изображения: 200 Кб - 1 Мб (в среднем 600 Кб)
	  2. Кол-во изображений: 1-5 (в среднем 3)
	Данные о посте:
      1. id поста - uuid - 36 байт
	  2. дата создания - timestamp - iso8601 - 20 байт
	  3. кол-во лайков - 4 Б
	  4. Размер подписи: 1 Кб
	  5. Размер геометки: 100 байт
	Итог: в среднем медиа 2 Мб
	      в среднем пост без медиа 1 Кб
	
RPS (read) = 10 000 000 * 50 / 86400 = 5800 \
RPS (write) в сезон = 10 000 000 * 1 / 86400 = 120 \
RPS (write) в несезон = 10 000 000 * (1 / 30) / 86400 = 4 

Для поста без медиа: \
Traffic (read) = 5800 * 1 Кб = 6 Мб/с \
Traffic (write) в сезон = 120 * 1 Кб = 150 Кб/с \
Traffic (write) в несезон = 4 * 1 Кб = 5 Кб/с

Для трафика медиа: \
Traffic (read) = 5800 * 2 Мб = 11 600 Мб/с = 12 Гб/с \
Traffic (write) в сезон = 120 * 2 Мб =  240 Мб/c = 250 Мб/с \
Traffic (write) в несезон = 4 * 2 Мб = 10 Мб/c

Итог: система нацелена больше на чтение

---

#### 2. Комментарии 

    Максимум комментарий - 1000 байт 
    В среднем комментарий - 300 байт

RPS (write) комментарии = 10 000 000 * 1 / 86400 = 120 \
Traffic (write) комментарии = 120 * 300 Б = 36 Кб/с

---

#### 3. Реакции и подписки

	Структура запроса на Реакцию и Подписку
	1. user_id - uuid - 36 байт
	2. post_id/user_id - uuid - 36 байт 
	3. timestamp - iso8601 - 20 байт 
	Итог: 92 байта

RPS (write) реакции = 10 000 000 * 5 / 86400 = 580 \
Traffic (write) реакции = 580 * 92 Б =  54 Кб/c

RPS (write) подписки = 10 000 000 * 2 / 86400 = 240 \
Traffic (write) подписки = 240 * 92 Б =  23 Кб/с

## Одновременные соедиенния

Connections = 10 000 000 * 0.1 = 1 000 000 соединений
